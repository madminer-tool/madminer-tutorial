<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Parton Level</title>
  <meta name="description" content="        Parton Level    MadMiner particle physics tutorial Part 2a: Analyzing events at parton level Johann Brehmer, Felix Kling, Irina Espejo, and Kyle Cran...">

  <link rel="canonical" href="https://cranmer.github.io/madminer-tutorial/tutorial_particle_physics/2a_parton_level_analysis.html">
  <link rel="alternate" type="application/rss+xml" title="MadMiner Tutorial" href="https://cranmer.github.io/madminer-tutorial/feed.xml">

  <meta property="og:url"         content="https://cranmer.github.io/madminer-tutorial/tutorial_particle_physics/2a_parton_level_analysis.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Parton Level" />
<meta property="og:description" content="        Parton Level    MadMiner particle physics tutorial Part 2a: Analyzing events at parton level Johann Brehmer, Felix Kling, Irina Espejo, and Kyle Cran..." />
<meta property="og:image"       content="https://iris-hep.org/assets/logos/madminer-square.png" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://cranmer.github.io/madminer-tutorial/tutorial_particle_physics/2a_parton_level_analysis.html",
  "headline": "Parton Level",
  "datePublished": "2020-03-03T11:41:04-05:00",
  "dateModified": "2020-03-03T11:41:04-05:00",
  "description": "        Parton Level    MadMiner particle physics tutorial Part 2a: Analyzing events at parton level Johann Brehmer, Felix Kling, Irina Espejo, and Kyle Cran...",
  "author": {
    "@type": "Person",
    "name": "Kyle Cranmer,"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://cranmer.github.io/madminer-tutorial",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://cranmer.github.io/madminer-tutorial",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/madminer-tutorial/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/madminer-tutorial/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>


  <!-- DOM updating function -->
  <script src="/madminer-tutorial/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/madminer-tutorial/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/madminer-tutorial';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/madminer-tutorial/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


<!-- Display Thebelab button in each code cell -->
<script>
/**
 * Set up thebelab button for code blocks
 */

const thebelabCellButton = id =>
  `<a id="thebelab-cell-button-${id}" class="btn thebebtn o-tooltip--left" data-tooltip="Interactive Mode">
    <img src="/madminer-tutorial/assets/images/edit-button.svg" alt="Start thebelab interactive mode">
  </a>`


const addThebelabButtonToCodeCells =  () => {

  const codeCells = document.querySelectorAll('div.input_area > div.highlight:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("thebelab-cell-button-" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', thebelabCellButton(id));
    }
  })
}

initFunction(addThebelabButtonToCodeCells);
</script>


<script src="https://unpkg.com/thebelab@latest/lib/index.js" async></script>
<script>
    /**
     * Add attributes to Thebelab blocks
     */

    const initThebelab = () => {
        const addThebelabToCodeCells = () => {
            console.log("Adding thebelab to code cells...");
            // If Thebelab hasn't loaded, wait a bit and try again. This
            // happens because we load ClipboardJS asynchronously.
            if (window.thebelab === undefined) {
                setTimeout(addThebelabToCodeCells, 250)
            return
            }

            // If we already detect a Thebelab cell, don't re-run
            if (document.querySelectorAll('div.thebelab-cell').length > 0) {
                return;
            }

            // Find all code cells, replace with Thebelab interactive code cells
            const codeCells = document.querySelectorAll('.input_area pre')
            codeCells.forEach((codeCell, index) => {
                const id = codeCellId(index)

                // Clean up the language to make it work w/ CodeMirror and add it to the cell
                dataLanguage = ""
                dataLanguage = detectLanguage(dataLanguage);
                codeCell.setAttribute('data-language', dataLanguage)
                codeCell.setAttribute('data-executable', 'true')

                // If the code cell is hidden, show it
                var inputCheckbox = document.querySelector(`input#hidebtn${codeCell.id}`);
                if (inputCheckbox !== null) {
                    setCodeCellVisibility(inputCheckbox, 'visible');
                }
            });

            // Remove the event listener from the page so keyboard press doesn't
            // Change page
            document.removeEventListener('keydown', initPageNav)
            keyboardListener = false;

            // Init thebelab
            thebelab.bootstrap();

            // Remove copy buttons since they won't work anymore
            const copyAndThebeButtons = document.querySelectorAll('.copybtn, .thebebtn')
            copyAndThebeButtons.forEach((button, index) => {
                button.remove();
            });

            // Remove outputs since they'll be stale
            const outputs = document.querySelectorAll('.output *, .output')
            outputs.forEach((output, index) => {
                output.remove();
            });

            // Find any cells with an initialization tag and ask ThebeLab to run them when ready
            var thebeInitCells = document.querySelectorAll('div.tag_thebelab-init');
            thebeInitCells.forEach((cell) => {
                console.log("Initializing ThebeLab with cell: " + cell.id);
                cell.querySelector('.thebelab-run-button').click();
            });
        }

        // Add event listener for the function to modify code cells
        const thebelabButtons = document.querySelectorAll('[id^=thebelab], [id$=thebelab]')
        thebelabButtons.forEach((thebelabButton,index) => {
            if (thebelabButton === null) {
                setTimeout(initThebelab, 250)
                return
            };
            thebelabButton.addEventListener('click', addThebelabToCodeCells);
        });
    }

    // Initialize Thebelab
    initFunction(initThebelab);

// Helper function to munge the language name
var detectLanguage = (language) => {
    if (language.indexOf('python') > -1) {
        language = "python";
    }
    return language;
}
</script>



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/madminer-tutorial/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '');
</script>



  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/madminer-tutorial/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/madminer-tutorial/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/madminer-tutorial/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("https://cranmer.github.io") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/madminer-tutorial/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/madminer-tutorial/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/madminer-tutorial/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "Made with Jupyter Book"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- Include the ThebeLab config so it gets reloaded on each page -->
    <script type="text/x-thebe-config">{
    requestKernel: true,
    binderOptions: {
    repo: "cranmer/madminer-tutorial",
    ref: "master",
    },
    codeMirrorConfig: {
    theme: "abcdef",
    mode: "python"
    },
    kernelOptions: {
    kernelName: "python2",
    path: "content/tutorial_particle_physics"
    }
}
</script>

    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="/madminer-tutorial/"><img src="https://iris-hep.org/assets/logos/madminer-square.png" class="textbook_logo" id="sidebar-logo" alt="textbook logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">MadMiner Tutorial</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro">
        <a class="c-sidebar__entry"
          href="/madminer-tutorial/intro.html"
        >
          
          Introduction
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">MadMiner Tutorial</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/preliminaries">
        <a class="c-sidebar__entry"
          href="/madminer-tutorial/preliminaries.html"
        >
          
          Preliminaries
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/overview">
        <a class="c-sidebar__entry"
          href="/madminer-tutorial/overview.html"
        >
          
          Overview
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/tutorial_particle_physics/1_setup">
        <a class="c-sidebar__entry"
          href="/madminer-tutorial/tutorial_particle_physics/1_setup.html"
        >
          
          Define process to study
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/morphing">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/morphing.html"
              >
                
                Morphing
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/morphing_basis/interactive_basis_chooser">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/morphing_basis/interactive_basis_chooser.html"
              >
                
                Interactive Morphing Demo
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/parton_or_delphes">
        <a class="c-sidebar__entry"
          href="/madminer-tutorial/parton_or_delphes.html"
        >
          
          Create training data
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/set_mg_dir">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/set_mg_dir.html"
              >
                
                Set MadGraph Directory
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/tutorial_particle_physics/2a_parton_level_analysis">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/tutorial_particle_physics/2a_parton_level_analysis.html"
              >
                
                Parton Level
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/tutorial_particle_physics/2b_delphes_level_analysis">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/tutorial_particle_physics/2b_delphes_level_analysis.html"
              >
                
                With Delphes
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/choose_surrogate">
        <a class="c-sidebar__entry"
          href="/madminer-tutorial/choose_surrogate.html"
        >
          
          Train model
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/tutorial_particle_physics/3a_likelihood_ratio">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/tutorial_particle_physics/3a_likelihood_ratio.html"
              >
                
                Likelihood Ratio
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/tutorial_particle_physics/3b_score">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/tutorial_particle_physics/3b_score.html"
              >
                
                Score
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/tutorial_particle_physics/3c_likelihood">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/tutorial_particle_physics/3c_likelihood.html"
              >
                
                Likelihood
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/statistics">
        <a class="c-sidebar__entry"
          href="/madminer-tutorial/statistics.html"
        >
          
          Statistical Analysis
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/tutorial_particle_physics/4a_limits">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/tutorial_particle_physics/4a_limits.html"
              >
                
                Limits on EFT parameters
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/tutorial_particle_physics/4b_fisher_information">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/tutorial_particle_physics/4b_fisher_information.html"
              >
                
                Fisher Information
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/tutorial_particle_physics/4c_information_geometry">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/tutorial_particle_physics/4c_information_geometry.html"
              >
                
                Information Geometry
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/congratulations">
        <a class="c-sidebar__entry"
          href="/madminer-tutorial/congratulations.html"
        >
          
          Congratulations
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/tutorial_particle_physics/A1_systematic_uncertainties">
        <a class="c-sidebar__entry"
          href="/madminer-tutorial/tutorial_particle_physics/A1_systematic_uncertainties.html"
        >
          
          Appendix
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/tutorial_particle_physics/A1_systematic_uncertainties">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/tutorial_particle_physics/A1_systematic_uncertainties.html"
              >
                
                Appendix
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/tutorial_particle_physics/A2_ensemble_methods">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/tutorial_particle_physics/A2_ensemble_methods.html"
              >
                
                Ensemble methods
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/tutorial_particle_physics/A3_reweighting_existing_samples">
              <a class="c-sidebar__entry"
                href="/madminer-tutorial/tutorial_particle_physics/A3_reweighting_existing_samples.html"
              >
                
                Reweighting existing samples
              </a>
            </li>
            
            
          
        </ul>
      

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://jupyterbook.org">Jupyter Book</a></p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button
      id="js-sidebar-toggle"
      class="hamburger hamburger--arrowalt is-active"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">
<div class="download-buttons-dropdown">
    <button id="dropdown-button-trigger" class="interact-button"><img src="/madminer-tutorial/assets/images/download-solid.svg" alt="Download" /></button>
    <div class="download-buttons">
        <a href="/madminer-tutorial/content/tutorial_particle_physics/2a_parton_level_analysis.ipynb" download>
        <button id="interact-button-download" class="interact-button">.ipynb</button>
        </a>
        
        <a id="interact-button-print"><button id="interact-button-download" class="interact-button">.pdf</button></a>
    </div>
</div>


  <button id="interact-button-thebelab" class="interact-button">Thebelab</button>

  
  






<a href="https://mybinder.org/v2/gh/cranmer/madminer-tutorial/master?filepath=content%2Ftutorial_particle_physics%2F2a_parton_level_analysis.ipynb"><button class="interact-button" id="interact-button-binder"><img class="interact-button-logo" src="/madminer-tutorial/assets/images/logo_binder.svg" alt="Interact" />Interactive</button></a>
  


</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title"><img src="/madminer-tutorial/assets/images/list-solid.svg" alt="Search" />   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/madminer-tutorial/search.html" class="topbar-right-button" id="search-button">
    <img src="/madminer-tutorial/assets/images/search-solid.svg" alt="Search" />
  </a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
                  <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Parton Level</div>
</div>
    
<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="MadMiner-particle-physics-tutorial">MadMiner particle physics tutorial<a class="anchor-link" href="#MadMiner-particle-physics-tutorial"> </a></h1><h1 id="Part-2a:-Analyzing-events-at-parton-level">Part 2a: Analyzing events at parton level<a class="anchor-link" href="#Part-2a:-Analyzing-events-at-parton-level"> </a></h1><p>Johann Brehmer, Felix Kling, Irina Espejo, and Kyle Cranmer 2018-2019</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this second part of the tutorial, we'll generate events and extract the observables and weights from them. You have two options: In this notebook we'll do this at parton level, in the alternative part 2b we use Delphes.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="0.-Preparations">0. Preparations<a class="anchor-link" href="#0.-Preparations"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before you execute this notebook, make sure you have a running installation of MadGraph.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">madminer.core</span> <span class="kn">import</span> <span class="n">MadMiner</span>
<span class="kn">from</span> <span class="nn">madminer.lhe</span> <span class="kn">import</span> <span class="n">LHEReader</span>
<span class="kn">from</span> <span class="nn">madminer.sampling</span> <span class="kn">import</span> <span class="n">combine_and_shuffle</span>
<span class="kn">from</span> <span class="nn">madminer.plotting</span> <span class="kn">import</span> <span class="n">plot_distributions</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># MadMiner output</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
    <span class="n">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)-5.5s</span><span class="s1"> </span><span class="si">%(name)-20.20s</span><span class="s1"> </span><span class="si">%(levelname)-7.7s</span><span class="s1"> </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%H:%M&#39;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span>
<span class="p">)</span>

<span class="c1"># Output of all other modules (e.g. matplotlib)</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">loggerDict</span><span class="p">:</span>
    <span class="k">if</span> <span class="s2">&quot;madminer&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Please enter here the path to your MG5 root directory:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">mg_dir</span> <span class="o">=</span> <span class="s1">&#39;/home/software/MG5_aMC_v2_6_2&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-Generate-events">1. Generate events<a class="anchor-link" href="#1.-Generate-events"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's load our setup:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">miner</span> <span class="o">=</span> <span class="n">MadMiner</span><span class="p">()</span>
<span class="n">miner</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;data/setup.h5&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>20:31 madminer.utils.inter DEBUG   HDF5 file does not contain is_reference field.
20:31 madminer.core        INFO    Found 2 parameters:
20:31 madminer.core        INFO       CWL2 (LHA: dim6 2, maximal power in squared ME: (2,), range: (-20.0, 20.0))
20:31 madminer.core        INFO       CPWL2 (LHA: dim6 5, maximal power in squared ME: (2,), range: (-20.0, 20.0))
20:31 madminer.core        INFO    Found 6 benchmarks:
20:31 madminer.core        INFO       sm: CWL2 = 0.00e+00, CPWL2 = 0.00e+00
20:31 madminer.core        INFO       w: CWL2 = 15.20, CPWL2 = 0.10
20:31 madminer.core        INFO       neg_w: CWL2 = -1.54e+01, CPWL2 = 0.20
20:31 madminer.core        INFO       ww: CWL2 = 0.30, CPWL2 = 15.10
20:31 madminer.core        INFO       neg_ww: CWL2 = 0.40, CPWL2 = -1.53e+01
20:31 madminer.core        INFO       morphing_basis_vector_5: CWL2 = -1.58e+01, CPWL2 = -1.94e+01
20:31 madminer.core        INFO    Found morphing setup with 6 components
20:31 madminer.core        INFO    Did not find systematics setup.
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In a next step, MadMiner starts MadGraph to generate events and calculate the weights. You can use <code>run()</code> or <code>run_multiple()</code>; the latter allows to generate different runs with different run cards and optimizing the phase space for different benchmark points.</p>
<p>In either case, you have to provide paths to the process card, run card, param card (the entries corresponding to the parameters of interest will be automatically adapted), and an empty reweight card. Log files in the <code>log_directory</code> folder collect the MadGraph output and are important for debugging.</p>
<p>The <code>sample_benchmark</code> (or in the case of <code>run_all</code>, <code>sample_benchmarks</code>) option can be used to specify which benchmark should be used for sampling, i.e. for which benchmark point the phase space is optimized. If you just use one benchmark, reweighting to far-away points in parameter space can lead to large event weights and thus large statistical fluctuations. It is therefore often a good idea to combine a lot of events at the "reference hypothesis" (for us the SM) and smaller samples from other benchmarks that span the parameter space.</p>
<p>One slight annoyance is that MadGraph only supports Python 2. The <code>run()</code> and <code>run_multiple()</code> commands have a keyword <code>initial_command</code> that let you load a virtual environment in which <code>python</code> maps to Python 2 (which is what we do below). Alternatively / additionally you can set <code>python2_override=True</code>, which calls <code>python2.7</code> instead of <code>python</code> to start MadGraph.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">miner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">sample_benchmark</span><span class="o">=</span><span class="s1">&#39;sm&#39;</span><span class="p">,</span>
    <span class="n">mg_directory</span><span class="o">=</span><span class="n">mg_dir</span><span class="p">,</span>
    <span class="n">mg_process_directory</span><span class="o">=</span><span class="s1">&#39;./mg_processes/signal1&#39;</span><span class="p">,</span>
    <span class="n">proc_card_file</span><span class="o">=</span><span class="s1">&#39;cards/proc_card_signal.dat&#39;</span><span class="p">,</span>
    <span class="n">param_card_template_file</span><span class="o">=</span><span class="s1">&#39;cards/param_card_template.dat&#39;</span><span class="p">,</span>
    <span class="n">run_card_file</span><span class="o">=</span><span class="s1">&#39;cards/run_card_signal_large.dat&#39;</span><span class="p">,</span>
    <span class="n">log_directory</span><span class="o">=</span><span class="s1">&#39;logs/signal&#39;</span><span class="p">,</span>
    <span class="n">initial_command</span><span class="o">=</span><span class="s2">&quot;source activate python2&quot;</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>20:31 madminer.utils.inter INFO    Generating MadGraph process folder from cards/proc_card_signal.dat at ./mg_processes/signal1
20:31 madminer.core        INFO    Run 0
20:31 madminer.core        INFO      Sampling from benchmark: sm
20:31 madminer.core        INFO      Original run card:       cards/run_card_signal_large.dat
20:31 madminer.core        INFO      Original Pythia8 card:   None
20:31 madminer.core        INFO      Copied run card:         /madminer/cards/run_card_0.dat
20:31 madminer.core        INFO      Copied Pythia8 card:     None
20:31 madminer.core        INFO      Param card:              /madminer/cards/param_card_0.dat
20:31 madminer.core        INFO      Reweight card:           /madminer/cards/reweight_card_0.dat
20:31 madminer.core        INFO      Log file:                run_0.log
20:31 madminer.core        INFO    Creating param and reweight cards in ./mg_processes/signal1//madminer/cards/param_card_0.dat, ./mg_processes/signal1//madminer/cards/reweight_card_0.dat
20:31 madminer.utils.inter INFO    Starting MadGraph and Pythia in ./mg_processes/signal1
20:43 madminer.core        INFO    Finished running MadGraph! Please check that events were succesfully generated in the following folders:

./mg_processes/signal1/Events/run_01


</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">additional_benchmarks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;ww&#39;</span><span class="p">,</span> <span class="s1">&#39;neg_w&#39;</span><span class="p">,</span> <span class="s1">&#39;neg_ww&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">miner</span><span class="o">.</span><span class="n">run_multiple</span><span class="p">(</span>
    <span class="n">sample_benchmarks</span><span class="o">=</span><span class="n">additional_benchmarks</span><span class="p">,</span>
    <span class="n">mg_directory</span><span class="o">=</span><span class="n">mg_dir</span><span class="p">,</span>
    <span class="n">mg_process_directory</span><span class="o">=</span><span class="s1">&#39;./mg_processes/signal2&#39;</span><span class="p">,</span>
    <span class="n">proc_card_file</span><span class="o">=</span><span class="s1">&#39;cards/proc_card_signal.dat&#39;</span><span class="p">,</span>
    <span class="n">param_card_template_file</span><span class="o">=</span><span class="s1">&#39;cards/param_card_template.dat&#39;</span><span class="p">,</span>
    <span class="n">run_card_files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cards/run_card_signal_small.dat&#39;</span><span class="p">],</span>
    <span class="n">log_directory</span><span class="o">=</span><span class="s1">&#39;logs/signal&#39;</span><span class="p">,</span>
    <span class="n">initial_command</span><span class="o">=</span><span class="s2">&quot;source activate python2&quot;</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>20:43 madminer.utils.inter INFO    Generating MadGraph process folder from cards/proc_card_signal.dat at ./mg_processes/signal2
20:44 madminer.core        INFO    Run 0
20:44 madminer.core        INFO      Sampling from benchmark: w
20:44 madminer.core        INFO      Original run card:       cards/run_card_signal_small.dat
20:44 madminer.core        INFO      Original Pythia8 card:   None
20:44 madminer.core        INFO      Copied run card:         /madminer/cards/run_card_0.dat
20:44 madminer.core        INFO      Copied Pythia8 card:     None
20:44 madminer.core        INFO      Param card:              /madminer/cards/param_card_0.dat
20:44 madminer.core        INFO      Reweight card:           /madminer/cards/reweight_card_0.dat
20:44 madminer.core        INFO      Log file:                run_0.log
20:44 madminer.core        INFO    Creating param and reweight cards in ./mg_processes/signal2//madminer/cards/param_card_0.dat, ./mg_processes/signal2//madminer/cards/reweight_card_0.dat
20:44 madminer.utils.inter INFO    Starting MadGraph and Pythia in ./mg_processes/signal2
20:46 madminer.core        INFO    Run 1
20:46 madminer.core        INFO      Sampling from benchmark: ww
20:46 madminer.core        INFO      Original run card:       cards/run_card_signal_small.dat
20:46 madminer.core        INFO      Original Pythia8 card:   None
20:46 madminer.core        INFO      Copied run card:         /madminer/cards/run_card_1.dat
20:46 madminer.core        INFO      Copied Pythia8 card:     None
20:46 madminer.core        INFO      Param card:              /madminer/cards/param_card_1.dat
20:46 madminer.core        INFO      Reweight card:           /madminer/cards/reweight_card_1.dat
20:46 madminer.core        INFO      Log file:                run_1.log
20:46 madminer.core        INFO    Creating param and reweight cards in ./mg_processes/signal2//madminer/cards/param_card_1.dat, ./mg_processes/signal2//madminer/cards/reweight_card_1.dat
20:46 madminer.utils.inter INFO    Starting MadGraph and Pythia in ./mg_processes/signal2
20:49 madminer.core        INFO    Run 2
20:49 madminer.core        INFO      Sampling from benchmark: neg_w
20:49 madminer.core        INFO      Original run card:       cards/run_card_signal_small.dat
20:49 madminer.core        INFO      Original Pythia8 card:   None
20:49 madminer.core        INFO      Copied run card:         /madminer/cards/run_card_2.dat
20:49 madminer.core        INFO      Copied Pythia8 card:     None
20:49 madminer.core        INFO      Param card:              /madminer/cards/param_card_2.dat
20:49 madminer.core        INFO      Reweight card:           /madminer/cards/reweight_card_2.dat
20:49 madminer.core        INFO      Log file:                run_2.log
20:49 madminer.core        INFO    Creating param and reweight cards in ./mg_processes/signal2//madminer/cards/param_card_2.dat, ./mg_processes/signal2//madminer/cards/reweight_card_2.dat
20:49 madminer.utils.inter INFO    Starting MadGraph and Pythia in ./mg_processes/signal2
20:51 madminer.core        INFO    Run 3
20:51 madminer.core        INFO      Sampling from benchmark: neg_ww
20:51 madminer.core        INFO      Original run card:       cards/run_card_signal_small.dat
20:51 madminer.core        INFO      Original Pythia8 card:   None
20:51 madminer.core        INFO      Copied run card:         /madminer/cards/run_card_3.dat
20:51 madminer.core        INFO      Copied Pythia8 card:     None
20:51 madminer.core        INFO      Param card:              /madminer/cards/param_card_3.dat
20:51 madminer.core        INFO      Reweight card:           /madminer/cards/reweight_card_3.dat
20:51 madminer.core        INFO      Log file:                run_3.log
20:51 madminer.core        INFO    Creating param and reweight cards in ./mg_processes/signal2//madminer/cards/param_card_3.dat, ./mg_processes/signal2//madminer/cards/reweight_card_3.dat
20:51 madminer.utils.inter INFO    Starting MadGraph and Pythia in ./mg_processes/signal2
20:54 madminer.core        INFO    Finished running MadGraph! Please check that events were succesfully generated in the following folders:

./mg_processes/signal2/Events/run_01
./mg_processes/signal2/Events/run_02
./mg_processes/signal2/Events/run_03
./mg_processes/signal2/Events/run_04


</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This will take a moment -- time for a coffee break!</p>
<p>After running any event generation through MadMiner, you should check whether the run succeeded: are the usual output files there, do the log files show any error messages? MadMiner does not (yet) perform any explicit checks, and if something went wrong in the event generation, it will only notice later when trying to load the event files.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Backgrounds">Backgrounds<a class="anchor-link" href="#Backgrounds"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also easily add other processes like backgrounds. An important option is the <code>is_background</code> keyword, which should be used for processes that do <em>not</em> depend on the parameters theta. <code>is_background=True</code> will disable the reweighting and re-use the same weights for all cross sections.</p>
<p>To reduce the runtime of the notebook, the background part is commented out here. Feel free to activate it and let it run during a lunch break.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">miner.run(</span>
<span class="sd">    is_background=True,</span>
<span class="sd">    sample_benchmark=&#39;sm&#39;,</span>
<span class="sd">    mg_directory=mg_dir,</span>
<span class="sd">    mg_process_directory=&#39;./mg_processes/background&#39;,</span>
<span class="sd">    proc_card_file=&#39;cards/proc_card_background.dat&#39;,</span>
<span class="sd">    param_card_template_file=&#39;cards/param_card_template.dat&#39;,</span>
<span class="sd">    run_card_file=&#39;cards/run_card_background.dat&#39;,</span>
<span class="sd">    log_directory=&#39;logs/background&#39;,</span>
<span class="sd">)</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>u&#34;\nminer.run(\n    is_background=True,\n    sample_benchmark=&#39;sm&#39;,\n    mg_directory=mg_dir,\n    mg_process_directory=&#39;./mg_processes/background&#39;,\n    proc_card_file=&#39;cards/proc_card_background.dat&#39;,\n    param_card_template_file=&#39;cards/param_card_template.dat&#39;,\n    run_card_file=&#39;cards/run_card_background.dat&#39;,\n    log_directory=&#39;logs/background&#39;,\n)\n&#34;</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, note that both <code>MadMiner.run()</code> and <code>MadMiner.run_multiple()</code> have a <code>only_create_script</code> keyword. If that is set to True, MadMiner will not start the event generation directly, but prepare folders with all the right settings and ready-to-run bash scripts. This might make it much easier to generate Events on a high-performance computing system.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Prepare-analysis-of-the-LHE-samples">2. Prepare analysis of the LHE samples<a class="anchor-link" href="#2.-Prepare-analysis-of-the-LHE-samples"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>madminer.lhe</code> submodule allows us to extract observables directly from the parton-level LHE samples, including an approximate description of the detector response with smearing functions. The central object is an instance of the <code>LHEProcessor</code> class, which has to be initialized with a MadMiner file:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">lhe</span> <span class="o">=</span> <span class="n">LHEReader</span><span class="p">(</span><span class="s1">&#39;data/setup.h5&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>20:54 madminer.utils.inter DEBUG   HDF5 file does not contain is_reference field.
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After creating the <code>LHEReader</code> object, one can add a number of event samples (the output of running MadGraph in step 1) with the <code>add_sample()</code> function.</p>
<p>In addition, you have to provide the information which sample was generated from which benchmark with the <code>sampled_from_benchmark</code> keyword, and set <code>is_background=True</code> for all background samples.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">lhe</span><span class="o">.</span><span class="n">add_sample</span><span class="p">(</span>
    <span class="n">lhe_filename</span><span class="o">=</span><span class="s1">&#39;mg_processes/signal1/Events/run_01/unweighted_events.lhe.gz&#39;</span><span class="p">,</span>
    <span class="n">sampled_from_benchmark</span><span class="o">=</span><span class="s1">&#39;sm&#39;</span><span class="p">,</span>
    <span class="n">is_background</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">k_factor</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">benchmark</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">additional_benchmarks</span><span class="p">):</span>
    <span class="n">lhe</span><span class="o">.</span><span class="n">add_sample</span><span class="p">(</span>
        <span class="n">lhe_filename</span><span class="o">=</span><span class="s1">&#39;mg_processes/signal2/Events/run_0{}/unweighted_events.lhe.gz&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">sampled_from_benchmark</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span>
        <span class="n">is_background</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">k_factor</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
    <span class="p">)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">lhe.add_sample(</span>
<span class="sd">    lhe_filename=&#39;mg_processes/background/Events/run_01/unweighted_events.lhe.gz&#39;,</span>
<span class="sd">    sampled_from_benchmark=&#39;sm&#39;,</span>
<span class="sd">    is_background=True,</span>
<span class="sd">    k_factor=1.0,</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>20:54 madminer.lhe         DEBUG   Adding event sample mg_processes/signal1/Events/run_01/unweighted_events.lhe.gz
20:54 madminer.lhe         DEBUG   Adding event sample mg_processes/signal2/Events/run_01/unweighted_events.lhe.gz
20:54 madminer.lhe         DEBUG   Adding event sample mg_processes/signal2/Events/run_02/unweighted_events.lhe.gz
20:54 madminer.lhe         DEBUG   Adding event sample mg_processes/signal2/Events/run_03/unweighted_events.lhe.gz
20:54 madminer.lhe         DEBUG   Adding event sample mg_processes/signal2/Events/run_04/unweighted_events.lhe.gz
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>u&#34;\nlhe.add_sample(\n    lhe_filename=&#39;mg_processes/background/Events/run_01/unweighted_events.lhe.gz&#39;,\n    sampled_from_benchmark=&#39;sm&#39;,\n    is_background=True,\n    k_factor=1.0,\n&#34;</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-Smearing-functions-to-model-the-detector-response">3. Smearing functions to model the detector response<a class="anchor-link" href="#3.-Smearing-functions-to-model-the-detector-response"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we have to define the smearing functions that are used (in lieu of a proper shower and detector simulation). Here we will assume a simple 10% uncertainty on the jet energy measurements and a $\pm 0.1$ smearing for jet $\eta$ and $\phi$. The transverse momenta of the jets are then derived from the smeared energy and the on-shell condition for the quarks (this is what <code>pt_resolution_abs=None</code> does). The photons from the Higgs are assumed to be measured perfectly (otherwise we'd have to call <code>set_smearing</code> another time with <code>pdgis=[22]</code>).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">lhe</span><span class="o">.</span><span class="n">set_smearing</span><span class="p">(</span>
    <span class="n">pdgids</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">],</span>   <span class="c1"># Partons giving rise to jets</span>
    <span class="n">energy_resolution_abs</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
    <span class="n">energy_resolution_rel</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">pt_resolution_abs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">pt_resolution_rel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
    <span class="n">eta_resolution_abs</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">eta_resolution_rel</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
    <span class="n">phi_resolution_abs</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">phi_resolution_rel</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In addition, we can define noise that only affects MET. This adds Gaussian noise with mean 0 and std <code>abs_ + rel * HT</code> to MET_x and MET_y separately.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">lhe</span><span class="o">.</span><span class="n">set_met_noise</span><span class="p">(</span><span class="n">abs_</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4.-Observables-and-cuts">4. Observables and cuts<a class="anchor-link" href="#4.-Observables-and-cuts"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next step is the definition of observables, either through a Python function or an expression that can be evaluated. Here we demonstrate the latter, which is implemented in <code>add_observable()</code>. In the expression string, you can use the terms <code>j[i]</code>, <code>e[i]</code>, <code>mu[i]</code>, <code>a[i]</code>, <code>met</code>, where the indices <code>i</code> refer to a ordering by the transverse momentum. In addition, you can use <code>p[i]</code>, which denotes the <code>i</code>-th particle in the order given in the LHE sample (which is the order in which the final-state particles where defined in MadGraph).</p>
<p>All of these represent objects inheriting from scikit-hep <a href="http://scikit-hep.org/api/math.html#vector-classes">LorentzVectors</a>, see the link for a documentation of their properties. In addition, they have <code>charge</code> and <code>pdg_id</code> properties.</p>
<p><code>add_observable()</code> has an optional keyword <code>required</code>. If <code>required=True</code>, we will only keep events where the observable can be parsed, i.e. all involved particles have been detected. If <code>required=False</code>, un-parseable observables will be filled with the value of another keyword <code>default</code>.</p>
<p>In a realistic project, you would want to add a large number of observables that capture all information in your events. Here we will just define two observables, the transverse momentum of the leading (= higher-pT) jet, and the azimuthal angle between the two leading jets.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">lhe</span><span class="o">.</span><span class="n">add_observable</span><span class="p">(</span>
    <span class="s1">&#39;pt_j1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;j[0].pt&#39;</span><span class="p">,</span>
    <span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">lhe</span><span class="o">.</span><span class="n">add_observable</span><span class="p">(</span>
    <span class="s1">&#39;delta_phi_jj&#39;</span><span class="p">,</span>
    <span class="s1">&#39;j[0].deltaphi(j[1]) * (-1. + 2.*float(j[0].eta &gt; j[1].eta))&#39;</span><span class="p">,</span>
    <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">lhe</span><span class="o">.</span><span class="n">add_observable</span><span class="p">(</span>
    <span class="s1">&#39;met&#39;</span><span class="p">,</span>
    <span class="s1">&#39;met.pt&#39;</span><span class="p">,</span>
    <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>20:54 madminer.lhe         DEBUG   Adding optional observable pt_j1 = j[0].pt with default 0.0
20:54 madminer.lhe         DEBUG   Adding required observable delta_phi_jj = j[0].deltaphi(j[1]) * (-1. + 2.*float(j[0].eta &gt; j[1].eta))
20:54 madminer.lhe         DEBUG   Adding required observable met = met.pt
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also add cuts, again in parse-able strings. In addition to the objects discussed above, they can contain the observables:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">lhe</span><span class="o">.</span><span class="n">add_cut</span><span class="p">(</span><span class="s1">&#39;(a[0] + a[1]).m &gt; 122.&#39;</span><span class="p">)</span>
<span class="n">lhe</span><span class="o">.</span><span class="n">add_cut</span><span class="p">(</span><span class="s1">&#39;(a[0] + a[1]).m &lt; 128.&#39;</span><span class="p">)</span>
<span class="n">lhe</span><span class="o">.</span><span class="n">add_cut</span><span class="p">(</span><span class="s1">&#39;pt_j1 &gt; 20.&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>20:54 madminer.lhe         DEBUG   Adding cut (a[0] + a[1]).m &gt; 122.
20:54 madminer.lhe         DEBUG   Adding cut (a[0] + a[1]).m &lt; 128.
20:54 madminer.lhe         DEBUG   Adding cut pt_j1 &gt; 20.
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="5.-Run-analysis-and-store-processes-events">5. Run analysis and store processes events<a class="anchor-link" href="#5.-Run-analysis-and-store-processes-events"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The function <code>analyse_samples</code> then calculates all observables from the LHE file(s) generated before, applies the smearing, and checks which events pass the cuts:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">lhe</span><span class="o">.</span><span class="n">analyse_samples</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>20:54 madminer.lhe         INFO    Analysing LHE sample mg_processes/signal1/Events/run_01/unweighted_events.lhe.gz: Calculating 3 observables, requiring 3 selection cuts, using 0 efficiency factors, associated with no systematics
20:54 madminer.lhe         DEBUG   Extracting nuisance parameter definitions from LHE file
20:54 madminer.utils.inter DEBUG   Parsing nuisance parameter setup from LHE file at mg_processes/signal1/Events/run_01/unweighted_events.lhe.gz
20:54 madminer.utils.inter DEBUG   Systematics setup: OrderedDict()
20:54 madminer.utils.inter DEBUG   1 weight groups
20:54 madminer.lhe         DEBUG   systematics_dict: OrderedDict()
20:54 madminer.utils.inter DEBUG   Parsing LHE file mg_processes/signal1/Events/run_01/unweighted_events.lhe.gz
20:54 madminer.utils.inter DEBUG   Parsing header and events as XML with cElementTree
20:54 madminer.utils.inter DEBUG   Found entry event_norm = sum in LHE header. Interpreting this as weight_norm_is_average = False.
20:54 madminer.utils.inter DEBUG   Event 1 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 2 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 3 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 4 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 5 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 6 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 7 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 8 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 9 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 10 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 11 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 12 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 13 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 14 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 15 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 16 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 17 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 18 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 19 passes observations, passes cuts, passes efficiencies -&gt; passes
20:54 madminer.utils.inter DEBUG   Event 20 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter INFO      50000 / 50000 events pass cut (a[0] + a[1]).m &gt; 122.
20:55 madminer.utils.inter INFO      50000 / 50000 events pass cut (a[0] + a[1]).m &lt; 128.
20:55 madminer.utils.inter INFO      49991 / 50000 events pass cut pt_j1 &gt; 20.
20:55 madminer.utils.inter INFO      49991 events pass all cuts/efficiencies
20:55 madminer.lhe         DEBUG   Found weights [u&#39;sm&#39;, u&#39;w&#39;, u&#39;neg_w&#39;, u&#39;ww&#39;, u&#39;neg_ww&#39;, u&#39;morphing_basis_vector_5&#39;] in LHE file
20:55 madminer.lhe         DEBUG   Found 49991 events
20:55 madminer.lhe         INFO    Analysing LHE sample mg_processes/signal2/Events/run_01/unweighted_events.lhe.gz: Calculating 3 observables, requiring 3 selection cuts, using 0 efficiency factors, associated with no systematics
20:55 madminer.lhe         DEBUG   Extracting nuisance parameter definitions from LHE file
20:55 madminer.utils.inter DEBUG   Parsing nuisance parameter setup from LHE file at mg_processes/signal2/Events/run_01/unweighted_events.lhe.gz
20:55 madminer.utils.inter DEBUG   Systematics setup: OrderedDict()
20:55 madminer.utils.inter DEBUG   1 weight groups
20:55 madminer.lhe         DEBUG   systematics_dict: OrderedDict()
20:55 madminer.utils.inter DEBUG   Parsing LHE file mg_processes/signal2/Events/run_01/unweighted_events.lhe.gz
20:55 madminer.utils.inter DEBUG   Parsing header and events as XML with cElementTree
20:55 madminer.utils.inter DEBUG   Found entry event_norm = sum in LHE header. Interpreting this as weight_norm_is_average = False.
20:55 madminer.utils.inter DEBUG   Event 1 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 2 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 3 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 4 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 5 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 6 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 7 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 8 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 9 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 10 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 11 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 12 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 13 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 14 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 15 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 16 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 17 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 18 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 19 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 20 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut (a[0] + a[1]).m &gt; 122.
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut (a[0] + a[1]).m &lt; 128.
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut pt_j1 &gt; 20.
20:55 madminer.utils.inter INFO      10000 events pass all cuts/efficiencies
20:55 madminer.lhe         DEBUG   Found weights [u&#39;sm&#39;, u&#39;w&#39;, u&#39;neg_w&#39;, u&#39;ww&#39;, u&#39;neg_ww&#39;, u&#39;morphing_basis_vector_5&#39;] in LHE file
20:55 madminer.lhe         DEBUG   Found 10000 events
20:55 root                 DEBUG   Merging data extracted from this file with data from previous files
20:55 root                 DEBUG     Weights for benchmark sm exist in both
20:55 root                 DEBUG     Weights for benchmark w exist in both
20:55 root                 DEBUG     Weights for benchmark neg_w exist in both
20:55 root                 DEBUG     Weights for benchmark ww exist in both
20:55 root                 DEBUG     Weights for benchmark neg_ww exist in both
20:55 root                 DEBUG     Weights for benchmark morphing_basis_vector_5 exist in both
20:55 madminer.lhe         INFO    Analysing LHE sample mg_processes/signal2/Events/run_02/unweighted_events.lhe.gz: Calculating 3 observables, requiring 3 selection cuts, using 0 efficiency factors, associated with no systematics
20:55 madminer.lhe         DEBUG   Extracting nuisance parameter definitions from LHE file
20:55 madminer.utils.inter DEBUG   Parsing nuisance parameter setup from LHE file at mg_processes/signal2/Events/run_02/unweighted_events.lhe.gz
20:55 madminer.utils.inter DEBUG   Systematics setup: OrderedDict()
20:55 madminer.utils.inter DEBUG   1 weight groups
20:55 madminer.lhe         DEBUG   systematics_dict: OrderedDict()
20:55 madminer.utils.inter DEBUG   Parsing LHE file mg_processes/signal2/Events/run_02/unweighted_events.lhe.gz
20:55 madminer.utils.inter DEBUG   Parsing header and events as XML with cElementTree
20:55 madminer.utils.inter DEBUG   Found entry event_norm = sum in LHE header. Interpreting this as weight_norm_is_average = False.
20:55 madminer.utils.inter DEBUG   Event 1 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 2 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 3 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 4 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 5 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 6 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 7 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 8 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 9 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 10 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 11 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 12 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 13 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 14 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 15 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 16 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 17 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 18 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 19 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 20 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut (a[0] + a[1]).m &gt; 122.
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut (a[0] + a[1]).m &lt; 128.
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut pt_j1 &gt; 20.
20:55 madminer.utils.inter INFO      10000 events pass all cuts/efficiencies
20:55 madminer.lhe         DEBUG   Found weights [u&#39;sm&#39;, u&#39;w&#39;, u&#39;neg_w&#39;, u&#39;ww&#39;, u&#39;neg_ww&#39;, u&#39;morphing_basis_vector_5&#39;] in LHE file
20:55 madminer.lhe         DEBUG   Found 10000 events
20:55 root                 DEBUG   Merging data extracted from this file with data from previous files
20:55 root                 DEBUG     Weights for benchmark sm exist in both
20:55 root                 DEBUG     Weights for benchmark w exist in both
20:55 root                 DEBUG     Weights for benchmark neg_w exist in both
20:55 root                 DEBUG     Weights for benchmark ww exist in both
20:55 root                 DEBUG     Weights for benchmark neg_ww exist in both
20:55 root                 DEBUG     Weights for benchmark morphing_basis_vector_5 exist in both
20:55 madminer.lhe         INFO    Analysing LHE sample mg_processes/signal2/Events/run_03/unweighted_events.lhe.gz: Calculating 3 observables, requiring 3 selection cuts, using 0 efficiency factors, associated with no systematics
20:55 madminer.lhe         DEBUG   Extracting nuisance parameter definitions from LHE file
20:55 madminer.utils.inter DEBUG   Parsing nuisance parameter setup from LHE file at mg_processes/signal2/Events/run_03/unweighted_events.lhe.gz
20:55 madminer.utils.inter DEBUG   Systematics setup: OrderedDict()
20:55 madminer.utils.inter DEBUG   1 weight groups
20:55 madminer.lhe         DEBUG   systematics_dict: OrderedDict()
20:55 madminer.utils.inter DEBUG   Parsing LHE file mg_processes/signal2/Events/run_03/unweighted_events.lhe.gz
20:55 madminer.utils.inter DEBUG   Parsing header and events as XML with cElementTree
20:55 madminer.utils.inter DEBUG   Found entry event_norm = sum in LHE header. Interpreting this as weight_norm_is_average = False.
20:55 madminer.utils.inter DEBUG   Event 1 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 2 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 3 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 4 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 5 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 6 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 7 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 8 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 9 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 10 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 11 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 12 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 13 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 14 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 15 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 16 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 17 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 18 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 19 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 20 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut (a[0] + a[1]).m &gt; 122.
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut (a[0] + a[1]).m &lt; 128.
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut pt_j1 &gt; 20.
20:55 madminer.utils.inter INFO      10000 events pass all cuts/efficiencies
20:55 madminer.lhe         DEBUG   Found weights [u&#39;sm&#39;, u&#39;w&#39;, u&#39;neg_w&#39;, u&#39;ww&#39;, u&#39;neg_ww&#39;, u&#39;morphing_basis_vector_5&#39;] in LHE file
20:55 madminer.lhe         DEBUG   Found 10000 events
20:55 root                 DEBUG   Merging data extracted from this file with data from previous files
20:55 root                 DEBUG     Weights for benchmark sm exist in both
20:55 root                 DEBUG     Weights for benchmark w exist in both
20:55 root                 DEBUG     Weights for benchmark neg_w exist in both
20:55 root                 DEBUG     Weights for benchmark ww exist in both
20:55 root                 DEBUG     Weights for benchmark neg_ww exist in both
20:55 root                 DEBUG     Weights for benchmark morphing_basis_vector_5 exist in both
20:55 madminer.lhe         INFO    Analysing LHE sample mg_processes/signal2/Events/run_04/unweighted_events.lhe.gz: Calculating 3 observables, requiring 3 selection cuts, using 0 efficiency factors, associated with no systematics
20:55 madminer.lhe         DEBUG   Extracting nuisance parameter definitions from LHE file
20:55 madminer.utils.inter DEBUG   Parsing nuisance parameter setup from LHE file at mg_processes/signal2/Events/run_04/unweighted_events.lhe.gz
20:55 madminer.utils.inter DEBUG   Systematics setup: OrderedDict()
20:55 madminer.utils.inter DEBUG   1 weight groups
20:55 madminer.lhe         DEBUG   systematics_dict: OrderedDict()
20:55 madminer.utils.inter DEBUG   Parsing LHE file mg_processes/signal2/Events/run_04/unweighted_events.lhe.gz
20:55 madminer.utils.inter DEBUG   Parsing header and events as XML with cElementTree
20:55 madminer.utils.inter DEBUG   Found entry event_norm = sum in LHE header. Interpreting this as weight_norm_is_average = False.
20:55 madminer.utils.inter DEBUG   Event 1 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 2 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 3 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 4 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 5 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 6 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 7 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 8 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 9 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 10 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 11 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 12 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 13 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 14 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 15 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 16 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 17 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 18 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 19 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter DEBUG   Event 20 passes observations, passes cuts, passes efficiencies -&gt; passes
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut (a[0] + a[1]).m &gt; 122.
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut (a[0] + a[1]).m &lt; 128.
20:55 madminer.utils.inter INFO      10000 / 10000 events pass cut pt_j1 &gt; 20.
20:55 madminer.utils.inter INFO      10000 events pass all cuts/efficiencies
20:55 madminer.lhe         DEBUG   Found weights [u&#39;sm&#39;, u&#39;w&#39;, u&#39;neg_w&#39;, u&#39;ww&#39;, u&#39;neg_ww&#39;, u&#39;morphing_basis_vector_5&#39;] in LHE file
20:55 madminer.lhe         DEBUG   Found 10000 events
20:55 root                 DEBUG   Merging data extracted from this file with data from previous files
20:55 root                 DEBUG     Weights for benchmark sm exist in both
20:55 root                 DEBUG     Weights for benchmark w exist in both
20:55 root                 DEBUG     Weights for benchmark neg_w exist in both
20:55 root                 DEBUG     Weights for benchmark ww exist in both
20:55 root                 DEBUG     Weights for benchmark neg_ww exist in both
20:55 root                 DEBUG     Weights for benchmark morphing_basis_vector_5 exist in both
20:55 madminer.lhe         INFO    Analysed number of events per sampling benchmark:
20:55 madminer.lhe         INFO      49991 from sm
20:55 madminer.lhe         INFO      10000 from w
20:55 madminer.lhe         INFO      10000 from neg_w
20:55 madminer.lhe         INFO      10000 from ww
20:55 madminer.lhe         INFO      10000 from neg_ww
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The values of the observables and the weights are then saved in the HDF5 file. It is possible to overwrite the same file, or to leave the original file intact and save all the data into a new file as follows:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">lhe</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;data/lhe_data.h5&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>20:55 madminer.lhe         DEBUG   Loading HDF5 data from data/setup.h5 and saving file to data/lhe_data.h5
20:55 madminer.lhe         DEBUG   Weight names: [u&#39;sm&#39;, u&#39;w&#39;, u&#39;neg_w&#39;, u&#39;ww&#39;, u&#39;neg_ww&#39;, u&#39;morphing_basis_vector_5&#39;]
20:55 madminer.utils.inter DEBUG   HDF5 file does not contain is_reference field.
20:55 madminer.utils.inter DEBUG   Benchmark morphing_basis_vector_5 already in benchmark_names_phys
20:55 madminer.utils.inter DEBUG   Benchmark neg_w already in benchmark_names_phys
20:55 madminer.utils.inter DEBUG   Benchmark neg_ww already in benchmark_names_phys
20:55 madminer.utils.inter DEBUG   Benchmark sm already in benchmark_names_phys
20:55 madminer.utils.inter DEBUG   Benchmark w already in benchmark_names_phys
20:55 madminer.utils.inter DEBUG   Benchmark ww already in benchmark_names_phys
20:55 madminer.utils.inter DEBUG   Combined benchmark names: [u&#39;sm&#39;, u&#39;w&#39;, u&#39;neg_w&#39;, u&#39;ww&#39;, u&#39;neg_ww&#39;, u&#39;morphing_basis_vector_5&#39;]
20:55 madminer.utils.inter DEBUG   Combined is_nuisance: [0 0 0 0 0 0]
20:55 madminer.utils.inter DEBUG   Combined is_reference: [1 0 0 0 0 0]
20:55 madminer.utils.inter DEBUG   Weight names found in event file: [u&#39;sm&#39;, u&#39;w&#39;, u&#39;neg_w&#39;, u&#39;ww&#39;, u&#39;neg_ww&#39;, u&#39;morphing_basis_vector_5&#39;]
20:55 madminer.utils.inter DEBUG   Benchmarks found in MadMiner file: [u&#39;sm&#39;, u&#39;w&#39;, u&#39;neg_w&#39;, u&#39;ww&#39;, u&#39;neg_ww&#39;, u&#39;morphing_basis_vector_5&#39;]
20:55 madminer.sampling    DEBUG   Combining and shuffling samples
20:55 madminer.sampling    DEBUG   Copying setup from data/lhe_data.h5 to data/lhe_data.h5
20:55 madminer.sampling    DEBUG   Loading samples from file 1 / 1 at data/lhe_data.h5, multiplying weights with k factor 1.0
20:55 madminer.sampling    DEBUG   Sampling benchmarks: [0 0 0 ... 4 4 4]
20:55 madminer.sampling    DEBUG   Combined sampling benchmarks: [0 0 0 ... 4 4 4]
20:55 madminer.sampling    DEBUG   Recalculated event numbers per benchmark: [49991 10000 10000 10000 10000     0], background: 0
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="6.-Plot-distributions">6. Plot distributions<a class="anchor-link" href="#6.-Plot-distributions"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see what our MC run produced:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_distributions</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;data/lhe_data.h5&#39;</span><span class="p">,</span>
    <span class="n">parameter_points</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sm&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">])],</span>
    <span class="n">line_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SM&#39;</span><span class="p">,</span> <span class="s1">&#39;BSM&#39;</span><span class="p">],</span>
    <span class="n">uncertainties</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
    <span class="n">n_bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">n_cols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">sample_only_from_closest_benchmark</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>20:55 madminer.analysis    INFO    Loading data from data/lhe_data.h5
20:55 madminer.analysis    INFO    Found 2 parameters
20:55 madminer.analysis    DEBUG      CWL2 (LHA: dim6 2, maximal power in squared ME: (2,), range: (-20.0, 20.0))
20:55 madminer.analysis    DEBUG      CPWL2 (LHA: dim6 5, maximal power in squared ME: (2,), range: (-20.0, 20.0))
20:55 madminer.analysis    INFO    Did not find nuisance parameters
20:55 madminer.analysis    INFO    Found 6 benchmarks, of which 6 physical
20:55 madminer.analysis    DEBUG      sm: CWL2 = 0.00e+00, CPWL2 = 0.00e+00
20:55 madminer.analysis    DEBUG      w: CWL2 = 15.20, CPWL2 = 0.10
20:55 madminer.analysis    DEBUG      neg_w: CWL2 = -1.54e+01, CPWL2 = 0.20
20:55 madminer.analysis    DEBUG      ww: CWL2 = 0.30, CPWL2 = 15.10
20:55 madminer.analysis    DEBUG      neg_ww: CWL2 = 0.40, CPWL2 = -1.53e+01
20:55 madminer.analysis    DEBUG      morphing_basis_vector_5: CWL2 = -1.58e+01, CPWL2 = -1.94e+01
20:55 madminer.analysis    INFO    Found 3 observables
20:55 madminer.analysis    DEBUG      0 pt_j1
20:55 madminer.analysis    DEBUG      1 delta_phi_jj
20:55 madminer.analysis    DEBUG      2 met
20:55 madminer.analysis    INFO    Found 89991 events
20:55 madminer.analysis    INFO      49991 signal events sampled from benchmark sm
20:55 madminer.analysis    INFO      10000 signal events sampled from benchmark w
20:55 madminer.analysis    INFO      10000 signal events sampled from benchmark neg_w
20:55 madminer.analysis    INFO      10000 signal events sampled from benchmark ww
20:55 madminer.analysis    INFO      10000 signal events sampled from benchmark neg_ww
20:55 madminer.analysis    INFO    Found morphing setup with 6 components
20:55 madminer.analysis    INFO    Did not find nuisance morphing setup
20:55 madminer.plotting    DEBUG   Observable indices: [0, 1, 2]
20:55 madminer.plotting    DEBUG   Calculated 2 theta matrices
20:55 madminer.analysis    DEBUG   Sampling benchmark closest to None: None
20:55 madminer.analysis    DEBUG   Events per benchmark: [49991. 10000. 10000. 10000. 10000.     0.]
20:55 madminer.plotting    DEBUG   Loaded raw data with shapes (89991, 3), (89991, 6)
20:55 madminer.analysis    DEBUG   Sampling benchmark closest to [0. 0.]: 0
20:55 madminer.analysis    DEBUG   Sampling benchmark closest to [10.  0.]: 1
20:55 madminer.plotting    DEBUG   Plotting panel 0: observable 0, label pt_j1
20:55 madminer.plotting    DEBUG   Ranges for observable pt_j1: min = [20.250223679913294, 20.250223679913294], max = [311.4531372780531, 1131.4092266890839]
20:55 madminer.plotting    DEBUG   Plotting panel 1: observable 1, label delta_phi_jj
20:55 madminer.plotting    DEBUG   Ranges for observable delta_phi_jj: min = [-3.1415902606030084, -3.1415902606030084], max = [3.1415635673903166, 3.1415635673903166]
20:55 madminer.plotting    DEBUG   Plotting panel 2: observable 2, label met
20:55 madminer.plotting    DEBUG   Ranges for observable met: min = [0.15734320281863676, 0.15734320281863676], max = [100.88382464398212, 581.6603427525945]
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/tutorial_particle_physics/2a_parton_level_analysis_42_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="7.-Combine-and-shuffle-different-samples">7. Combine and shuffle different samples<a class="anchor-link" href="#7.-Combine-and-shuffle-different-samples"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To reduce disk usage, you can generate several small event samples with the steps given above, and combine them now. Note that (for now) it is essential that all of them are generated with the same setup, including the same benchmark points / morphing basis!</p>
<p>This is generally good practice even if you use just one sample, since the events might have some inherent ordering (e.g. from sampling from different hypotheses). Later when we split the events into a training and test fraction, such an ordering could cause problems.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">combine_and_shuffle</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;data/lhe_data.h5&#39;</span><span class="p">],</span>
    <span class="s1">&#39;data/lhe_data_shuffled.h5&#39;</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>20:55 madminer.sampling    DEBUG   Combining and shuffling samples
20:55 madminer.sampling    DEBUG   Copying setup from data/lhe_data.h5 to data/lhe_data_shuffled.h5
20:55 madminer.sampling    DEBUG   Loading samples from file 1 / 1 at data/lhe_data.h5, multiplying weights with k factor 1.0
20:55 madminer.sampling    DEBUG   Sampling benchmarks: [2 1 0 ... 0 1 0]
20:55 madminer.sampling    DEBUG   Combined sampling benchmarks: [2 1 0 ... 0 1 0]
20:55 madminer.sampling    DEBUG   Recalculated event numbers per benchmark: [49991 10000 10000 10000 10000     0], background: 0
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

 


    </main>
    
            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  
    
    

    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/madminer-tutorial/set_mg_dir.html">
       <span class="u-margin-right-tiny"></span> Set MadGraph Directory
    </a>
  

  
    

    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/madminer-tutorial/tutorial_particle_physics/2b_delphes_level_analysis.html">
      With Delphes <span class="u-margin-right-tiny"></span> 
    </a>
  
</nav>

              <footer>
  <p class="footer">This page was created by <a href="https://github.com/diana-hep/madminer">The MadMiner Team</a>. The source is <a href="https://github.com/cranmer/madminer-tutorial">here</a>.</p>
</footer>

            </div>

        </div>
      </main>
    </div>
  </body>
</html>
